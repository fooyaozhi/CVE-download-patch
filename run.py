import subprocess
import shutil
import sys
import os

def initialize():
    if os.path.exists('Log'):
        shutil.rmtree('Log')
    if os.path.exists('srj-patch_files'):
        shutil.rmtree('srj-patch_files')
    if os.path.exists('patch_msg.json'):
        os.remove('patch_msg.json')


if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python3 run.py <cve_list_file>")
        sys.exit(1)
    cve_list_file = sys.argv[1]
    print("CVE list file: ", cve_list_file)
    scripts = ["cve_patch_extractor.py", "cve_patch_downloader.py", "cve_patch_parser.py"]
    # scripts = ["cve_patch_extractor.py"]
    initialize()
    for script in scripts:
        print("\n+++++++ Running script: ", script)
        if script == "cve_patch_extractor.py":
            subprocess.call(["python3", script, cve_list_file])
        else:
            subprocess.call(["python3", script])